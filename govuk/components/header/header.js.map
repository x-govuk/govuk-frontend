{"version":3,"file":"header.js","sources":["../../../../src/govuk/components/header/header.mjs"],"sourcesContent":["/**\n * Header component\n *\n * @class\n * @param {Element} $module - HTML element to use for header\n */\nfunction Header ($module) {\n  if (!($module instanceof HTMLElement)) {\n    return this\n  }\n\n  /** @deprecated Will be made private in v5.0 */\n  this.$module = $module\n\n  /** @deprecated Will be made private in v5.0 */\n  this.$menuButton = $module.querySelector('.govuk-js-header-toggle')\n\n  /** @deprecated Will be made private in v5.0 */\n  this.$menu = this.$menuButton && $module.querySelector(\n    '#' + this.$menuButton.getAttribute('aria-controls')\n  )\n\n  /**\n   * Save the opened/closed state for the nav in memory so that we can\n   * accurately maintain state when the screen is changed from small to\n   * big and back to small\n   *\n   * @deprecated Will be made private in v5.0\n   */\n  this.menuIsOpen = false\n\n  /**\n   * A global const for storing a matchMedia instance which we'll use to\n   * detect when a screen size change happens. We set this later during the\n   * init function and rely on it being null if the feature isn't available\n   * to initially apply hidden attributes\n   *\n   * @deprecated Will be made private in v5.0\n   */\n  this.mql = null\n}\n\n/**\n * Initialise component\n *\n * Check for the presence of the header, menu and menu button â€“ if any are\n * missing then there's nothing to do so return early.\n * Feature sniff for and apply a matchMedia for desktop which will\n * trigger a state sync if the browser viewport moves between states. If\n * matchMedia isn't available, hide the menu button and present the \"no js\"\n * version of the menu to the user.\n */\nHeader.prototype.init = function () {\n  // Check that required elements are present\n  if (!this.$module || !this.$menuButton || !this.$menu) {\n    return\n  }\n\n  if ('matchMedia' in window) {\n    // Set the matchMedia to the govuk-frontend desktop breakpoint\n    this.mql = window.matchMedia('(min-width: 48.0625em)')\n\n    if ('addEventListener' in this.mql) {\n      this.mql.addEventListener('change', this.syncState.bind(this))\n    } else {\n      // addListener is a deprecated function, however addEventListener\n      // isn't supported by IE or Safari < 14. We therefore add this in as\n      // a fallback for those browsers\n\n      // @ts-expect-error Property 'addListener' does not exist\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n      this.mql.addListener(this.syncState.bind(this))\n    }\n\n    this.syncState()\n    this.$menuButton.addEventListener('click', this.handleMenuButtonClick.bind(this))\n  } else {\n    this.$menuButton.setAttribute('hidden', '')\n  }\n}\n\n/**\n * Sync menu state\n *\n * Uses the global variable menuIsOpen to correctly set the accessible and\n * visual states of the menu and the menu button.\n * Additionally will force the menu to be visible and the menu button to be\n * hidden if the matchMedia is triggered to desktop.\n *\n * @deprecated Will be made private in v5.0\n */\nHeader.prototype.syncState = function () {\n  if (this.mql.matches) {\n    this.$menu.removeAttribute('hidden')\n    this.$menuButton.setAttribute('hidden', '')\n  } else {\n    this.$menuButton.removeAttribute('hidden')\n    this.$menuButton.setAttribute('aria-expanded', this.menuIsOpen.toString())\n\n    if (this.menuIsOpen) {\n      this.$menu.removeAttribute('hidden')\n    } else {\n      this.$menu.setAttribute('hidden', '')\n    }\n  }\n}\n\n/**\n * Handle menu button click\n *\n * When the menu button is clicked, change the visibility of the menu and then\n * sync the accessibility state and menu button state\n *\n * @deprecated Will be made private in v5.0\n */\nHeader.prototype.handleMenuButtonClick = function () {\n  this.menuIsOpen = !this.menuIsOpen\n  this.syncState()\n}\n\nexport default Header\n"],"names":[],"mappings":"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"}