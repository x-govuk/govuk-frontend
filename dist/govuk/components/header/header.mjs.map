{"version":3,"file":"header.mjs","sources":["../../../../src/govuk/components/header/header.mjs"],"sourcesContent":["/**\n * Header component\n */\nexport class Header {\n  /** @private */\n  $module\n\n  /** @private */\n  $menuButton\n\n  /** @private */\n  $menu\n\n  /**\n   * Save the opened/closed state for the nav in memory so that we can\n   * accurately maintain state when the screen is changed from small to\n   * big and back to small\n   *\n   * @private\n   */\n  menuIsOpen = false\n\n  /**\n   * A global const for storing a matchMedia instance which we'll use to\n   * detect when a screen size change happens. We rely on it being null if the\n   * feature isn't available to initially apply hidden attributes\n   *\n   * @private\n   * @type {MediaQueryList | null}\n   */\n  mql = null\n\n  /**\n   * Apply a matchMedia for desktop which will trigger a state sync if the browser\n   * viewport moves between states.\n   *\n   * @param {Element} $module - HTML element to use for header\n   */\n  constructor ($module) {\n    if (!($module instanceof HTMLElement) || !document.body.classList.contains('govuk-frontend-supported')) {\n      return this\n    }\n\n    this.$module = $module\n    this.$menuButton = $module.querySelector('.govuk-js-header-toggle')\n    this.$menu = this.$menuButton && $module.querySelector(\n      `#${this.$menuButton.getAttribute('aria-controls')}`\n    )\n\n    if (\n      !(\n        this.$menuButton instanceof HTMLElement ||\n        this.$menu instanceof HTMLElement\n      )\n    ) {\n      return this\n    }\n\n    // Set the matchMedia to the govuk-frontend desktop breakpoint\n    this.mql = window.matchMedia('(min-width: 48.0625em)')\n\n    // MediaQueryList.addEventListener isn't supported by Safari < 14 so we need\n    // to be able to fall back to the deprecated MediaQueryList.addListener\n    if ('addEventListener' in this.mql) {\n      this.mql.addEventListener('change', () => this.syncState())\n    } else {\n      // @ts-expect-error Property 'addListener' does not exist\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n      this.mql.addListener(() => this.syncState())\n    }\n\n    this.syncState()\n    this.$menuButton.addEventListener('click', () => this.handleMenuButtonClick())\n  }\n\n  /**\n   * Sync menu state\n   *\n   * Uses the global variable menuIsOpen to correctly set the accessible and\n   * visual states of the menu and the menu button.\n   * Additionally will force the menu to be visible and the menu button to be\n   * hidden if the matchMedia is triggered to desktop.\n   *\n   * @private\n   */\n  syncState () {\n    if (this.mql.matches) {\n      this.$menu.removeAttribute('hidden')\n      this.$menuButton.setAttribute('hidden', '')\n    } else {\n      this.$menuButton.removeAttribute('hidden')\n      this.$menuButton.setAttribute('aria-expanded', this.menuIsOpen.toString())\n\n      if (this.menuIsOpen) {\n        this.$menu.removeAttribute('hidden')\n      } else {\n        this.$menu.setAttribute('hidden', '')\n      }\n    }\n  }\n\n  /**\n   * Handle menu button click\n   *\n   * When the menu button is clicked, change the visibility of the menu and then\n   * sync the accessibility state and menu button state\n   *\n   * @private\n   */\n  handleMenuButtonClick () {\n    this.menuIsOpen = !this.menuIsOpen\n    this.syncState()\n  }\n}\n"],"names":["Header","constructor","$module","$menuButton","$menu","menuIsOpen","mql","HTMLElement","document","body","classList","contains","querySelector","getAttribute","window","matchMedia","addEventListener","syncState","addListener","handleMenuButtonClick","matches","removeAttribute","setAttribute","toString"],"mappings":"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"}